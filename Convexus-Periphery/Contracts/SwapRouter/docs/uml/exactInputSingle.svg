<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1184px" preserveAspectRatio="none" style="width:1105px;height:1184px;background:#FFFFFF;" version="1.1" viewBox="0 0 1105 1184" width="1105px" zoomAndPan="magnify"><defs><filter height="300%" id="f1opjzad88t57m" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="47" x2="47" y1="40.2969" y2="1140.7969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="388" x2="388" y1="40.2969" y2="1140.7969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="728.5" x2="728.5" y1="40.2969" y2="1140.7969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="911.5" x2="911.5" y1="40.2969" y2="1140.7969"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1059" x2="1059" y1="40.2969" y2="1140.7969"/><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="80" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="12" y="24.9951">recipient</text><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="80" x="5" y="1139.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66" x="12" y="1159.792">recipient</text><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="68" x="352" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="359" y="24.9951">Token0</text><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="68" x="352" y="1139.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="359" y="1159.792">Token0</text><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="101" x="676.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="683.5" y="24.9951">SwapRouter</text><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="101" x="676.5" y="1139.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="683.5" y="1159.792">SwapRouter</text><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="113" x="853.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="860.5" y="24.9951">ConvexusPool</text><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="113" x="853.5" y="1139.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="860.5" y="1159.792">ConvexusPool</text><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="68" x="1023" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1030" y="24.9951">Token1</text><rect fill="#FEFECE" filter="url(#f1opjzad88t57m)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="68" x="1023" y="1139.7969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="1030" y="1159.792">Token1</text><polygon fill="#A80036" points="376,264.1563,386,268.1563,376,272.1563,380,268.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="47" x2="382" y1="268.1563" y2="268.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="54" y="66.3638">transfer (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="66" y="81.4966">SwapRouter,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="66" y="96.6294">amount0, {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="74" y="111.7622">"method":"exactInputSingle",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="74" y="126.895">"params": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="82" y="142.0278">"tokenOut": token1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="82" y="157.1606">"fee": fee,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="82" y="172.2935">"recipient": recipient,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="82" y="187.4263">"deadline": deadline,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285" x="82" y="202.5591">"amountOutMinimum": amountOutMinimum,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243" x="82" y="217.6919">"sqrtPriceLimitX96": sqrtPriceLimitX96</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="70" y="232.8247">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="62" y="247.9575">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="54" y="263.0903">)</text><polygon fill="#A80036" points="717,490.0156,727,494.0156,717,498.0156,721,494.0156" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="388" x2="723" y1="494.0156" y2="494.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="395" y="292.2231">tokenFallback (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="407" y="307.356">recipient,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="407" y="322.4888">amount0, {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="415" y="337.6216">"method":"exactInputSingle",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="415" y="352.7544">"params": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="423" y="367.8872">"tokenOut": token1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="423" y="383.02">"fee": fee,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="423" y="398.1528">"recipient": recipient,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="423" y="413.2856">"deadline": deadline,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285" x="423" y="428.4185">"amountOutMinimum": amountOutMinimum,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="243" x="423" y="443.5513">"sqrtPriceLimitX96": sqrtPriceLimitX96</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="411" y="458.6841">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="403" y="473.8169">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="395" y="488.9497">)</text><polygon fill="#A80036" points="900,609.9453,910,613.9453,900,617.9453,904,613.9453" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="729" x2="906" y1="613.9453" y2="613.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="736" y="518.0825">swap (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="744" y="533.2153">recipient,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30" x="744" y="548.3481">true,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="744" y="563.481">amount0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="744" y="578.6138">sqrtPriceLimitX96,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="744" y="593.7466">bytes(recipient)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="736" y="608.8794">)</text><polygon fill="#A80036" points="1047,714.7422,1057,718.7422,1047,722.7422,1051,718.7422" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="912" x2="1053" y1="718.7422" y2="718.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="919" y="638.0122">transfer (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="927" y="653.145">recipient,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="927" y="668.2778">amount1, {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="935" y="683.4106">"method": "pay"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="927" y="698.5435">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="919" y="713.6763">)</text><polygon fill="#A80036" points="58,819.5391,48,823.5391,58,827.5391,54,823.5391" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="52" x2="1058" y1="823.5391" y2="823.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="64" y="742.8091">tokenFallback (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="72" y="757.9419">ConvexusPool,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="72" y="773.0747">amount1, {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="80" y="788.2075">"method": "pay"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="72" y="803.3403">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="64" y="818.4731">)</text><polygon fill="#A80036" points="740,909.2031,730,913.2031,740,917.2031,736,913.2031" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="734" x2="911" y1="913.2031" y2="913.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="746" y="847.606">convexusSwapCallback (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="754" y="862.7388">amount0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="754" y="877.8716">amount1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="754" y="893.0044">recipient</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="746" y="908.1372">)</text><polygon fill="#A80036" points="399,1014,389,1018,399,1022,395,1018" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="393" x2="728" y1="1018" y2="1018"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="405" y="937.27">transfer (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="413" y="952.4028">ConvexusPool,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="413" y="967.5356">amount0, {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="421" y="982.6685">"method": "pay"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="413" y="997.8013">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="405" y="1012.9341">)</text><polygon fill="#A80036" points="900,1118.7969,910,1122.7969,900,1126.7969,904,1122.7969" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="388" x2="906" y1="1122.7969" y2="1122.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="395" y="1042.0669">tokenFallback (</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="403" y="1057.1997">SwapRouter,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="403" y="1072.3325">amount0, {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="411" y="1087.4653">"method": "pay"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="9" x="403" y="1102.5981">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="395" y="1117.731">)</text><!--MD5=[76e6f7cd8f0e5e0044c03e9d101d12bb]
@startuml
' Send the tokens to the SwapRouter contract
recipient -> Token0 : transfer ( \n   SwapRouter, \n   amount0, { \n     "method":"exactInputSingle", \n     "params": {\n       "tokenOut": token1, \n       "fee": fee, \n       "recipient": recipient, \n       "deadline": deadline, \n       "amountOutMinimum": amountOutMinimum, \n       "sqrtPriceLimitX96": sqrtPriceLimitX96 \n    } \n  } \n)

Token0 -> SwapRouter : tokenFallback ( \n   recipient, \n   amount0, { \n     "method":"exactInputSingle", \n     "params": {\n       "tokenOut": token1, \n       "fee": fee, \n       "recipient": recipient, \n       "deadline": deadline, \n       "amountOutMinimum": amountOutMinimum, \n       "sqrtPriceLimitX96": sqrtPriceLimitX96 \n    } \n  } \n)

' The SwapRouter contract performs the swap method
SwapRouter -> ConvexusPool : swap ( \n  recipient, \n  true, \n  amount0, \n  sqrtPriceLimitX96, \n  bytes(recipient) \n)

' The swapped tokens are paid back to the recipient
ConvexusPool -> Token1 : transfer ( \n  recipient, \n  amount1, { \n    "method": "pay" \n  } \n)

Token1 -> recipient : tokenFallback ( \n  ConvexusPool, \n  amount1, { \n    "method": "pay" \n  } \n)

ConvexusPool -> SwapRouter : convexusSwapCallback (\n  amount0, \n  amount1, \n  recipient \n)

' The SwapRouter contract send the required amount0 of token0
SwapRouter -> Token0 : transfer ( \n  ConvexusPool, \n  amount0, { \n    "method": "pay" \n  } \n)

Token0 -> ConvexusPool : tokenFallback ( \n  SwapRouter, \n  amount0, { \n    "method": "pay" \n  } \n)
@enduml

@startuml
recipient -> Token0 : transfer ( \n   SwapRouter, \n   amount0, { \n     "method":"exactInputSingle", \n     "params": {\n       "tokenOut": token1, \n       "fee": fee, \n       "recipient": recipient, \n       "deadline": deadline, \n       "amountOutMinimum": amountOutMinimum, \n       "sqrtPriceLimitX96": sqrtPriceLimitX96 \n    } \n  } \n)

Token0 -> SwapRouter : tokenFallback ( \n   recipient, \n   amount0, { \n     "method":"exactInputSingle", \n     "params": {\n       "tokenOut": token1, \n       "fee": fee, \n       "recipient": recipient, \n       "deadline": deadline, \n       "amountOutMinimum": amountOutMinimum, \n       "sqrtPriceLimitX96": sqrtPriceLimitX96 \n    } \n  } \n)

SwapRouter -> ConvexusPool : swap ( \n  recipient, \n  true, \n  amount0, \n  sqrtPriceLimitX96, \n  bytes(recipient) \n)

ConvexusPool -> Token1 : transfer ( \n  recipient, \n  amount1, { \n    "method": "pay" \n  } \n)

Token1 -> recipient : tokenFallback ( \n  ConvexusPool, \n  amount1, { \n    "method": "pay" \n  } \n)

ConvexusPool -> SwapRouter : convexusSwapCallback (\n  amount0, \n  amount1, \n  recipient \n)

SwapRouter -> Token0 : transfer ( \n  ConvexusPool, \n  amount0, { \n    "method": "pay" \n  } \n)

Token0 -> ConvexusPool : tokenFallback ( \n  SwapRouter, \n  amount0, { \n    "method": "pay" \n  } \n)
@enduml

PlantUML version 1.2022.1beta4(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>